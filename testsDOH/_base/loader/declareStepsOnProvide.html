<html>
<head>
	<script type="text/javascript" src="../../../dojo.js"></script>
	<script type="text/javascript">
		require(["dojo", "doh", "dojo/testsDOH/_base/loader/declareStepsOnProvideAmd"], 
			function(dojo, doh, declareStepsOnProvide, declareStepsOnProvide1) {
			doh.register("loader.declareStepsOnProvide", function(t){
				var instance= new declareStepsOnProvide();
				t.is(instance.status(), "OK");
				// requiring dojo/testsDOH/_base/loader/declareStepsOnProvideAmd caused
				// dojo/testsDOH/_base/loader/declareStepsOnProvide to load which loaded *two* modules 
				// and dojo.declare stepped on both of them
				var instance= new (require("dojo/testsDOH/_base/loader/declareStepsOnProvide1"))();
				t.is(instance.status(), "OK-1");
			});
			doh.runOnLoad();
		});
	</script>
</head>
<body>
  <h1>check console</h1>
  <p>This tests a legacy module that has two dojo.provides and both are stepped on by dojo.declare.</p>
</body>
</html>
